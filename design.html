<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>OWidgets</title>
        <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
        <!-- Bootstrap icons-->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet" />
        <!-- Google fonts-->
        <link rel="preconnect" href="https://fonts.gstatic.com" />
        <link href="https://fonts.googleapis.com/css2?family=Newsreader:ital,wght@0,600;1,600&amp;display=swap" rel="stylesheet" />
        <link href="https://fonts.googleapis.com/css2?family=Mulish:ital,wght@0,300;0,500;0,600;0,700;1,300;1,500;1,600;1,700&amp;display=swap" rel="stylesheet" />
        <link href="https://fonts.googleapis.com/css2?family=Kanit:ital,wght@0,400;1,400&amp;display=swap" rel="stylesheet" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="css/styles.css" rel="stylesheet" />
    </head>
    <body id="page-top">
        <!-- Navigation-->
        <nav class="navbar navbar-expand-lg navbar-light fixed-top shadow-sm" id="mainNav">
            <div class="container px-5">
                <a class="navbar-brand fw-bold" href="index.html">
                    <img src="assets/img/ow-logo.svg" height="30" class="d-inline-block align-top" alt="">
                    OWidgets
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    Menu
                    <i class="bi-list"></i>
                </button>
                <div class="collapse navbar-collapse" id="navbarResponsive">
                    <ul class="navbar-nav ms-auto me-4 my-3 my-lg-0">
                        <li class="nav-item"><a class="nav-link me-lg-3" href="requirements.html">Requirements</a></li>
                        <li class="nav-item"><a class="nav-link me-lg-3" href="research.html">Research</a></li>
                        <li class="nav-item"><a class="nav-link me-lg-3" href="hci.html">HCI</a></li>
                        <li class="nav-item active"><a class="nav-link me-lg-3" href="design.html">Design</a></li>
                        <li class="nav-item"><a class="nav-link me-lg-3" href="implementation.html">Implementation</a></li>
                        <li class="nav-item"><a class="nav-link me-lg-3" href="testing.html">Testing</a></li>
                        <li class="nav-item"><a class="nav-link me-lg-3" href="evaluation.html">Evaluation</a></li>
                        <li class="nav-item"><a class="nav-link me-lg-3" href="appendix.html">Appendix</a></li>
                    </ul>
                </div>
            </div>
        </nav>

        <div class="page-header">
            <aside class="text-center bg-gradient-primary-to-secondary">
                <div class="container px-5">
                    <div class="row gx-5 justify-content-center">
                        <div class="h2 fs-1 text-white font-alt mb-4">System Design</div>
                    </div>
                </div>
            </aside>
        </div>

        <div class="container px-5 page-content mb-4">
            <div class="row gx-5 justify-content-center mb-4">
                <div class="h4 fs-1 text-black font-alt page-subheading">System Architecture<hr></div>
                <div class="fs-5 text-black">
                    <!-- REPLACE THIS W OVERALL SYS STRUCTURE -->
                    <img src="assets/img/design/overall-structure.png" class="img-fluid" alt="Web Architecture"><br><br>
                    
                    The above diagram shows the overall system architecture of our project. The user interface, run from the <code>app.py</code> file, consists of 7 main pages which access the functionalities of the following major classes, modules and files on the back-end:<br>
                    <ul>
                        <li>Data collection system: 
                            <code>DataSynthesizer</code>, <code>Ow06</code> and <code>SensorLoggr</code>
                        </li>
                        <li>Machine learning system:
                            <code>ModelPage</code>, <code>FeatureExtractor</code> and <code>ModelTrainer</code>
                        </li>
                        <li>Databases:
                            <code>ScentDBHandler</code>, <code>ModelDBHandler</code> and <code>IdentifiedDBHandler</code>
                        </li>
                        <li>Configuration and output data files</li>
                    </ul>

                    The modules in grey are key dependencies that are not written by our team.<br><br>

                    <span class="fs-4 fw-bold">Data collection system</span><br>
                    <code>DataSynthesizer</code> is the main class which handles the automated data collection system. It makes use of the <code>Ow06</code> class, which controls the olfactometer and was provided to us by OWidgets, and the <code>SensorLogger</code> class, which controls the BME680 sensor.<br><br>

                    The output of the data synthesizer is stored in two seperate folders: <code>raw</code> and <code>features</code>. The <code>raw</code> folder contains the raw data from the sensors and olfactometer, while the <code>features</code> folder contains the processed data. The data is stored in CSV format for easy access and manipulation.<br><br>

                    The CSV files in the <code>raw</code> folder store the raw readings and data from the sensor and olfactometer recorded during data collection. They contain the following fields: <code>DataPoint|Time(s)|ScentNum|Stabilizing|ChanOn|ScentDuration(s)|Temp(C)|Pressure(hPa)|Humidity(%)|HeaterIndex|HeaterTemp(C)|HeaterDur(ms)|Resistance(Ohm)</code>.<br><br>
                    
                    The CSV files in the <code>features</code> folder contain fields including the mean, median, mode, standard deviation, and other statistical measures of the raw data. They are generated in between data collection cycles, while the sensor stabilises.<br><br>

                    <span class="fs-4 fw-bold">Machine learning system</span><br>

                    The machine learning system is made up of three modules: <code>ModelPage</code>, <code>FeatureExtractor</code> and <code>ModelTrainer</code>.<br><br>

                    <code>FeatureExtractor</code> handles the extraction of features from the raw data collected by the data collection system. It is used for automatic feature extraction during data collection, and for processing data during the training process.<br><br>

                    <code>ModelTrainer</code> handles the training of the model using the extracted features. It uses the extracted features to train the model, and then saves the model to a file for later use.<br><br>

                    <code>ModelPage</code> is a wrapper class which uses functions from both the <code>FeatureExtractor</code> and <code>ModelTrainer</code> classes to extract features and train the model. It also handles identification from a given file. This class neatly packages the functions from the other two classes into 9 steps to train a model, beginning at feature extraction and ending at saving the model:<br>
                    <ol>
                        <li>Load raw features</li>
                        <li>Manually select features</li>
                        <li>Pre-process data</li>
                        <li>Set block configuration</li>
                        <li>Construct model</li>
                        <li>Prepare training</li>
                        <li>Train model</li>
                        <li>Plot metrics</li>
                        <li>Save model</li>
                    </ol>
                    <br>

                    <span class="fs-4 fw-bold">Databases</span><br>
                    The databases are all stored in CSV files. They are read with database handler classes, which each handle the individual formats for the databases. Each database handler class inherits from the abstract parent class <code>DatabaseHandler</code>. The storage formats for each database, and how they are handled by the individual classes, can be found in the <a href="implementation.html">Implementation</a> page. Below is a database schema showing the relationships between the databases:<br><br>
                    <div class="img-flex research-img">
                        <img src="assets/img/design/db-schema.png" class="img-fluid" alt="Web Architecture"><br><br>
                    </div>
                    
                    
                    
                    <span class="fs-4 fw-bold">Web Application Structure</span><br>
                    Our full web application structure is as shown:<br>
                    <ul>
                        <li>Green boxes: Main web pages</li>
                        <li>Blue boxes: Web applications involving <code>ModelPage</code></li>
                        <li>Orange boxes: Database handler classes</li>
                        <li>Purple boxes: Miscellaneous helper functions</li>
                    </ul>
                    
                    <img src="assets/img/design/web-app-design.png" class="img-fluid" alt="Web Architecture"><br><br>

                    Each of the pages on the web application have a function which the URL is routed to, which displays the respective pages. Each functionality on the UI which requires a response from the server has each own route and function which accesses the other back-end functionality and files where required. These functions are called via AJAX requests from the front-end.<br><br>

                    Since the web server is running concurrently with the data collection system on the Raspberry Pi, it allows easy access to controlling the hardware, accessing the databases and using the machine learning models.<br><br>
                   
                </div>

                <div class="h4 fs-1 text-black font-alt page-subheading">UI Design<hr></div>
                <div class="fs-5 text-black">
                    <span class="fs-4 fw-bold">Design principles</span><br>
                    In designing our UI, we followed key design principles to ensure that our interface was user-friendly and intuitive. Below are the key principles we followed and how we implemented them.<br><br>
                    
                    <strong>Simplicity</strong> refers to keeping interfaces clear, straightforward, and easy to understand for users. This can be done by removing clutter and presenting information clearly and concisely. We did this by:
                    <ul>
                        <li>Keeping elements such as data tables small, with a scroll bar, to prevent them from cluttering the screen when they have large amounts of data being displayed</li>
                        <li>Using large, bold titles to indicate what the page is for, followed by smaller titles for each important section of the page to indicate their purposes</li>
                    </ul>
                    <br>

                    <strong>Consistency</strong> ensures that elements, patterns, and interactions within the UI are uniform and predictable across different screens and contexts, allowing the user to navigate the UI more efficiently. We did this by:
                    <ul>
                        <li>Using the same headers, subheaders, and text font sizes and colors in every page</li>
                        <li>Ensuring the consistent size and colors of buttons and dropdown lists</li>
                    </ul>
                    <br>

                    <strong>Visibility</strong> refers to making important elements, actions, and status indicators clearly visible and easily accessible to users, helping them understand what they can do and what is happening within the interface. We did this by:
                    <ul>
                        <li>Clearly labeling buttons with both text and representative colors to let the user know their function</li>
                    </ul>
                    <br>

                    <strong>Affordance</strong> refers to designing elements in a way that indicates to users how to interact with each element, helping them understand what actions are possible within the interface. We did this by:
                    <ul>
                        <li>Indicating a field is a dropdown list with a small downwards-facing triangle</li>
                        <li>Highlighting buttons with a darker border to indicate clickability</li>
                    </ul>
                    <br>

                    <strong>Mapping</strong> involves aligning the layout and organization of elements with the actions or functions they represent, making it easier for users to understand the relationship between controls and outcomes. We did this by:
                    <ul>
                        <li>Placing buttons near the elements they affect (e.g., "Add row" button at the bottom of the table for schedules)</li>
                        <li>Positioning required input fields (e.g., file names) next to the buttons for submission to indicate to the user that they should fill in the field first</li>
                    </ul>
                    <br>

                    <strong>Constraints</strong> set limits or boundaries on user interactions within the interface, guiding users towards desired actions and preventing errors or unintended outcomes. We did this by:
                    <ul>
                        <li>Using a dropdown list for selecting scents in the olfactometer schedule to prevent users from selecting a non-existent scent</li>
                        <li>Utilizing a sliding input to set the repetition rate, preventing users from entering a value out of the acceptable range</li>
                        <li>Replacing the start button with a stop button when clicked and vice versa, preventing users from starting or stopping the data collection system multiple times</li>
                    </ul>
                    <br>

                    <span class="fs-4 fw-bold">Sketches</span><br>
                    We designed our UI by meeting with our client and discussing their requirements. We then created the following sketches based on their feedback:<br>
                    <!-- INSERT SKETCHES HERE -->

                    <br><br>
                    <span class="fs-4 fw-bold">Interactive prototype</span><br>
                    We used Figma to build an interactive prototype, which can be found here:
                    <!-- INSERT LINK TO FIGMA -->
                    <br><br>
            </div>
        </div>

        <footer class="bg-black text-center py-5">
            <div class="container px-5">
                <div class="text-white-50 small">
                    <div class="mb-2">&copy; Your Website 2023. All Rights Reserved.</div>
                    <a href="#!">Privacy</a>
                    <span class="mx-1">&middot;</span>
                    <a href="#!">Terms</a>
                    <span class="mx-1">&middot;</span>
                    <a href="#!">FAQ</a>
                </div>
            </div>
        </footer>
        
        <!-- Bootstrap core JS-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Core theme JS-->
        <script src="js/scripts.js"></script>
        <script src="https://cdn.startbootstrap.com/sb-forms-latest.js"></script>
    </body>
</html>
